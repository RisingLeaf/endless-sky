# Copyright (c) 2023 by RisingLeaf (https://github.com/RisingLeaf)
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.

mission "Incipias: Guardian of Incipias Space"
	invisible
	landing
	repeat
	to offer
		not "Incipias: Guardian of Incipias Space: active"
	to complete
		never
	npc save
		government "Drak (Incipias)"
		personality heroic vindictive frugal forbearing
		system Il'le
		ship "Archon (Hyperdrive Only)" "Guardian of Spring"

mission "Incipias: Warning of the Guardian"
	invisible
	landing
	to complete
		never
	on enter Il'le
		conversation
			`"You came to a dead end, maybe try another route," a voice with uncertain origin says.`
			`	Alarmed by the sudden appearance you turn around but nobody is there. You check your scanners but only a few indigenous lifeforms that showed no sign of communication appear. Also you notice that your mapping system found hyperlinks stretching out from this system.`
			choice
				`	(It was probably your imagiation, ignore it.)`
				`	"You cant fool me, this is no dead end."`
					goto reason
				`	"Why should I listen to you?"`
					goto reason
			`	"Ignoring me wont help you, turn around," the same voice says, again with no indication of where it came from.`
			choice
				`	"You cant fool me, this is no dead end."`
				`	"Why should I listen to you?"`
			label reason
			`	"Here lie the unborn flowers yet to come to full bloom. There is nothing here for you to find, listen to my advice and turn back." The voice sounds more energetic this time and you get the impression that is coming out of your head.`
			choice
				`	"Unborn flowers, that sounds interesting."`
				`	"I will see for myself."`
			`	A sigh seems to drif through the continuum, "Human, these unborn flowers," an impresion of euphoria comes over you, "would only be in danger by your presence, please respect the beauty of life and do not step into this region that will soon bring forth a new species. Your kind is much more advanced than everything that you could hope to find here, no merits await you."`
			choice
				`	"Why do you care about these flowers?"`
					goto care
				`	"Maybe what I search is not technology."`
			`	The voice now in what you might call an understanding and calm tone says, "Your persistence on this topic is admirable but allow me to explain my conviction with an example." You say nothing, so the voice continues.`
			label care
			`	"Why do humans care about art?" The voice now seems far away yet more present than ever, "Because it amazes you, the same way it amazes us to see another kind grow and overcome their burdens, life of species are like a painting that never stop being painted and when they do stop it is one of the sadest things to watch. That is why we try to protect these creations of life itself and see what heights they can reach."`
			`	The voice pauses before continuing, "I see that you can not be convinced by me, even though I could just wipe you out here and now I do not favor violence, I will let you pass, but I will be watching you as I am," and you can hear the ultimate resolution in the voice, "the guardian of this space."`
				`	The voice fades out leaving nothing behind but the feeling of being watched.`
				decline

mission "Incipias: First Contact I"
	invisible
	landing
	to complete
		never
	on enter Dom'us
		conversation
			`As you enter the system, you notice ships of a type you have never seen before. Hailing them only gives you static. After some more unsuccessful attempts, you give up. Maybe you can find some more information in nearby systems.`
				to display
					not "Incipias: Meet the Quarg: offered"
			`As you enter the system, you notice ships of a type you have never seen before. Hailing them only gives you static. After some more unsuccessful attempts, you give up. This must be the species the Quarg talked about.`
				to display
					has "Incipias: Meet the Quarg: offered"



mission "Incipias: Meet the Quarg"
	invisible
	landing
	source
		government "Quarg (Incipias)"
	to complete
		never
	on offer
		conversation
			branch "ut divitas" "spec inci"
				has "flagship planet: Ut Divitas"
			label "ut divitas"
			`Your spaceship lands with a soft jolt. A small group of Quarg quickly gathers around your ship, making some simple but clear gestures telling you to wait. After they noticed that you understood them, one of them walks away in a hurried manner.`
			`	Only a moment later the Quarg returns with another Quarg. The new one starts talking with a very strange accent.`
				goto "both planets"
			label "spec inci"
			`You land on one of the automated landing pads. As soon as you shut your engines off it starts to move into a hangar slot. The gates of the hangar close. You leave your ship and notice a door on the side of the hangar, a sign there is showing something in a foreign language, but as you get closer it turns white for a moment, before the words "HUMAN DETECTED, PLEASE WAIT WHILE ASSISTANCE IS ON THE WAY" appear. Left with no other choice you have to stay where you are.`
			`	Luckily it only takes a few minutes until the doors open and three Quarg appear behind it. The one in the middle is wearing clothing that makes clear that it is a military official. The two in the back are wearing full combat gear but do not seem to expect a fight. The one in the middle starts talking in a very strange accent.`
			label "both planets"
			`	"Welcome human, long ways came you. Kind of yours never here have been, your mission?"`
			choice
				`	"I am just exploring the galaxy."`
					goto "explorer"
				`	"I am looking for new species."`
					goto "new species"
			label "explorer"
			`	"An obvious pursuit for the young that is," it nods, "if advice you I may, to not walk this way in a careless manner, the galaxy holds many dangers that your kind has yet to discover or even to understand." It straightens up to its full height, towering over you, "but in the end worth the trouble it will be."`
				goto "end"
			label "new species"
			`	"What a peculiar task that is," it looks confused and tilts its head, "what to achieve by this you hope? That an incredible amount of dangers come with meeting other species you not know? For a reason invisible borders in space there are. To be careful and consider every last step I advise."`
			label "end"
			`	After a short pause it continues talking, "Your presence here our kind accepts, although not very happy we are. Allowed to travel here you are, but conditions there are. Not too far from here another kind just starts growing, great plans for them our leaders have. Do not interrupt them, hostile actions against them we will revenge."`
			`	With these words the Quarg turns around and leaves. It seems like you are free to use the local facilities now.`

# Maybe add a version of the ships sprite that looks damaged/modded.
ship "Nimbus" "Nimbus FTL"
	add attributes
		"bunks" -25
	outfits
		"Liquid-Class Shield"
		"Metallic Hydrogen Cell"
		"Cloud Piercer" 20

		"MH Red-Class Engine"
		"MH Red-Class Steering"

mission "Incipias: The derelict"
	landing
	invisible
	to offer
		has "Incipias: Meet the Quarg: offered"
	npc assist
		government "Hicemus"
		ship "Nimbus FTL" "HIC Veni #000001"
		system "Hui'uc"
		to despawn
			has "incipias: helped the derelict"
		on assist
			conversation
				`When you approach the ship you get hailed and as you accept the hail color gradients start moving over your screen but your speakers stay silent. It seems like communication over these channels is doomed to fail, you continue your boarding maneuver.`
				scene "scene/incipias message"
				`	You manage to dock to the disabled ship quite easily. The lock opens and a hallway opens up before you, obviously not built for humans. The walls are strangely curved and the floor has nearly no grip at all. Your view gets caught by the five giant aliens half octopode, half jellyfish that are pulsating in bright colors, similar to the gradients that appeared on your screen earlier. One of them is floating behind a giant mounted gun, the two barrels are pointed right at you. The gunner flashes in an orange light, and you can feel the tension in the room rising.`
				choice
					"Try to convey that you intend no harm."
						goto peace
					`(Drop the repair equipment and run back into your ship.)`
						goto flee
					`(Try to make a non-lethal shot at the one behind the turret and run!)`
				`	You hit the creature manning the turret, causing it to explode with a strident sound. Before you can enjoy your short-lived victory, the other turret aims your way. Turning your head you see the gunner flashing in a deep red, before shooting you down, avenging their fallen comrade.`
					die
				label peace
				`	Feeling that the situation could escalate every moment, you slowly place the crate with the repair equipment on the ground, careful to not make any hasty movements and walk back a few steps. No side moves for a moment until one of the aliens slowly moves forward, tones of yellow are now mixing into the orange. Two of their tentacles wrap around the crate, the other four are backing of a little bit. The front one succeeds in finding the opening mechanism, right after it got a look inside, its colors shift to a weak green. The other four also seem to relax as they take on the same color.`
				`	With the repair equipment delivered there is nothing else you can do and communication is not working so you turn around and leave. Just as you leave you can see how the aliens start pulsating in all colors of the spectrum, gradients are moving over their skin so fast that it almost looks white.`
					goto end
				label flee
				`	As the tension starts raising even further, you just drop the repair equipment and run back into your ship, you smash the button that closes the lock. You get a last look on the alien, blue and yellow tones are mixing on their skin, but they are not taking any action.`
				label end
				`	As you fly away you see the engines of the ship slowly booting back up. Apparently they figured out how to use the repair equipment.`
				`	Back on the bridge your eyes fall on the scanner log that is still open on your screen. Notably this ship had no hyperdrive or anything similar installed; strange considering there is no inhabited planet in this system. Maybe you should talk to the Quarg and see if they can help.`
				action
					set "incipias: helped the derelict"
		personality
			confusion 50
			derelict uninterested staying
	on enter "Hui'uc"
		conversation
			`On entering the system you find an alien spaceship disabled and badly damaged. You remember your training as a captain when your teacher told you about something about a codex of captains, "A captain never leaves a ship in need behind."`

mission "Incipias: Help the stranded Part 1"
	landing
	source
		government "Quarg (Incipias)"
	destination "Pon'tes"
	to offer
		has "incipias: helped the derelict"
	on offer
		conversation
			`Right after you arrived on the planet you go looking for a Quarg official to tell about the stranded ship. Luckily it does not take long before you find one.`
			`	"Human, in quite a haste you seem to be. What the so pressing matter could be?" It asks as it clearly recognizes that you are a bit out of breath.`
			choice
				`	(Explain the situation.)`
					goto explanation
				`	"I need advice regarding the species in this region."`
			`	It looks at you curiously, "So you met them? I am surprised that you were able to communicate, it took a very long time even for us to decipher their way of communication."`
			`	You quickly explain what happened and the Quarg seems very relieved about the fact that you were not able to talk to them, it probably was a big achievement for them.`
			label explanation
			`	"A most peculiar situation you ran into, should not be able to cross the borders of their system yet this species..." It tilts it head for a moment considering what you just said. "To help them I would love, but no ships we have that on gas giants can land and too early it is for us to reveal ourselves to them, I fear nothing there is we can do." It shakes its head.`
			choice
				`	"Then let me help them."`
					goto initiative
				`	"How can you make such a cold-hearted decision?"`
			`	"This difficult for you to understand might be, but the greater good over the sole life I have to place. If ourselves show to them now by the shock of such and advanced species existing will be created chaos."`
			choice
				`	"Then let me help them."`
					goto initiative
				`	"You can deal with the consequences later, help them now!"`
			`	"Insisting you sure are human, understand I can your point but intervention by us out of question it is. But a proposal for you I have, to you, a solo captain the means to help I will grant, of course some conditions there are."`
			choice
				`	"Sure let me do the work."`
				`	"If you are too weak..."`
			`	Something like a giggle comes from the Quarg, before continuing.`
			label initiative
			`	"Your initiative most welcome is human, but not the tools for such a mission you have. To my knowledge no vessels capable of landing on gas giants ever developed by your kind. And as said you, not capable of communicating with them you are."`
			`	"But help you I can at one point, communication that is. I can provide you with a single one of our translators, which will allow you to contact the species in their home system. To sell you one of their ships ask to them, easy it won't be."`
			`	It pauses before getting very serious, "but remember one thing you have to, do not to give them any advanced technology of yours. If you agree to that point help you we shall."`
			choice
				`	"If that is how I can help them."`
					goto yes
				`	"Yes, but why do you want me not to sell my tech?"`
			`	"Interrupting the natural grow of a species not predictable the consequences are even letting you contact them a great risk is. But that one willing to take I am for the lives of these souls."`
			label yes
			`	"Happy I am that you agree to that condition. Please for a moment wait here," it says and hurrilly walks away.`
			`	It only takes it a moment to get back carrying a sleek silver box with a display on one side.`
			`	"Our translator this is. Into your language it can translate thanks to our database. Be aware of the honor of me handing this you," it says, handing the translator over.`
			`	As you stow it away it explains how to use it. "Oh and captain one last thing, the complexity of their language even we can not express, the translator might not be able to translate some parts directly, when it happens you will notice."`
			`	The quarg wishes you best of luck and leaves you alone. Time to head to Dom'us.`
				accept
	on enter Dom'us
		"reputation: Hicemus" += 10
		conversation
			`Entering the system with the translator, you prepare to broadcast your first message.`
			choice
				`	"Hello. I am captain <first> <last> here to make contact."`
				`	"Greetings, strangers. I seek to help you."`
				# silly option will probably remove it but for now it is just funny
				`	"Howdy aliens, I come in peace.`
			`	For a minute, nothing happens at all, it seems like a communication went off.`
			`	After some time, a motion goes through all ships in the system and then a channel opens from the space station. Colors rush over your display a mix of yellow and green, and you point the translator to the display as the Quarg told you.`
			`	"Welcome [stranger, danger] we greet you in [this space, our home]."`
			`	The colors stop before rushing over your screen again.`
			`	"What is your [intention, purpose] here?"`
			choice
				`	"I am here to make peaceful contact with you."`
				`	"I want to help stranded ones of your kind."`
			`	Again a long pause. "Your intentions are [kind, noble]. Please dock to [our station, our capital]."`
			`	Along the message comes a small plan of the station with the docking ports highlighted.`
	on complete
		conversation
			`Thanks to the plans you are easily able to dock with the station. Your airlock opens and you enter an environment like nothing you ever saw before. There are no visible pathways but foggy hallways some even going up vertically. A crowd of beings gathered in front of your airlock each pulsating in a multitude of colors. A group of five floats in front of the crowd. The middle one starts communicating with you pulsating in calm colors.`
			`	"Welcome [otherworldly being, standing one] we are the Incipias, welcome to [our home, our capital]."`
			`	It stops as if awaiting an answer.`
			choice
				`	"Greetings, Incipias. I am a human."`
				`	"I thank you for your hospitality."`
			`	A movement goes through the crowd colors now going through them like waves.`
			`	The speaker (or would you call him painter?) continues, "You are the first other being that ever [communicated, made friends]. Are you the only [danger, other being] out there?"`
			choice
				`	"No, there are others too."`
				`	"The galaxy is full of other beings."`
			`	Another wave goes through the crowd. "So there are more. But, stranger, how can we [help, befriend] you?"`
			choice
				`	(Tell them about the stranded and how you want to help them.)`
					goto stranded
				`	"I want one of your ships."`
			`	"[I, we] shall allow you to buy one. If that is all that it takes to make you a [friend, not danger]. If that is all please excuse us, we need to talk about what this new situation means for us, I hope we can [talk to, question] you more another time."`
				goto end
			label stranded
			`	Another wave goes through the crowd but this time you notice an overflow in green tones.`
			`	"So they [are still alive, made the big step]. We shall give you access to our [ships, achievements]. Let us prepare the shipyard, we hope to [speak to, question] you more on another occasion.`
			label end
			`	The five float away but the crowd stays continues staring at you, probably out of interest.`
			`	You should get yourself a ship and install a hyperdrive on it to save the stranded ones in the Hui'uc system.`

mission "Incipias: Help the stranded Part 2"
	landing
	passengers 5
	source
		planet Turra
	destination "Pon'tes"
	to offer
		has "Incipias: Help the stranded Part 1: done"
	on offer
		conversation
			`Your ship dives into the clouds of the gas giant, an environment on a scale you never experienced before. Giant clouds tower like castles, sometimes opening to giant caverns. Whirlwinds brush through the atmosphere like pillars holding the sky. Even though the winds are brutal your ship glides through them as if they had no effect at all.`
			`	You activate your scanners looking for the stranded ship. Soon a small blip appears on your screen. You maneuver your ship to that point. The stranded ship looks even worse than the first time; the storms seem to have damaged some of the hull. The shields must have broken when they ran out of fuel.`
			`	You receive no answer to your hail. Your scanners indicate that it ran out of energy.`
			`	You carefully maneuver your ship closer, until you can dock with the Incipias ship.`
			`	When the lock opens five Incipias float in front of you. Noticing your presence they quickly back off, they were clearly not expecting a human in one of their kind's ships. It takes a moment for them to recognize you.`
			choice
				`	"Hello, I have come to save you."`
				`	"I have been sent by your people to get you home."`
			`	They seem to switch from a tense state to a surprised one.`
			`	One of them starts pulsating, "You [speak, light] our language? How [surprising, good]. We would not have survived [much longer, a single day] here. You are our savior. We would love to talk more, but a [storm, calamity] is coming, we should leave now."`
			`	You tell them to come aboard and launch away from the planet.`
				accept
	on complete
		conversation
			`When you land on the station your passengers thank you again and leave, probably to get some well-earned rest.`
			`	As you step out of the <ship> an Incipias approaches you. "Follow me [stranger, helper] before a crowd gathers, we would like to talk."`
			`	It guides you through the hallways avoiding larger groups, only moving through horizontal corridors. You arrive in a large room with a view over the entire station. Three Incipias are already in the room. One starts glowing.`
			`	"Welcome. We are the leaders of the Hicemus, the [reigning, most powerful] government of the Incipias. If you agree we would like to ask you a few questions. In return we would be open for questions too."`
			choice
				`	"Sorry but I have other stuff to do."`
					goto endNoTime
				`	"Sure, ask something."`
			`	A green glow comes from all of them, "Thank you for taking the time. Can you tell us more about the [unknown territory, galaxy] surrounding us?"`
			choice
				`	(Give them an exhausting story of what you have seen so far.)`
					goto detail
				`	(Give a rough overview of what you have seen.)`
			`	After watching your explanation a quickfire of colors that your translator can not follow is exchanged between them, you mostly see yellow tones mixed with green and red.`
			`	"Thank you for this insight. All we [knew, gathered] until now was by observing stars. To think that there is so much out there, it truly invokes determination to explore.`
				goto yours
			label detail
			`	After watching your story a quickfire of colors that your translator can not follow is exchanged between them, you mostly see yellow tones mixed with green.`
			`	"Thank you for this exhaustive insight. All we [knew, gathered] until now was by observing stars close to us. To think that there is so much out there, it truly invokes determination to explore.`
			label yours
			`	"But now to you, is there anything you would like to know?"`
			# might add to this list over time
			label choice
			choice
				`	"I do not have any more questions."`
					goto end
				`	"Why do you call this station your capital?"`
					goto capital
				`	"Why can I not land on your home planet?"`
			`	A flash of red appears for only a second, "Our [old home, origin] is not directly ruled by us. They may approach you separately at some point in the future, be [careful, disgusted] of their lights. They have outdated values long laid off by us, who are progressing fast.`
				goto choice
			label capital
			`	The one pulsating now takes on a bright green color, "This station is our greatest achievement, our [gateway, bridge] to the stars. In honor of our urge to [expand, explore] we made this station our capital to demonstrate our determination."`
				goto choice
			label end
			`	"Thank you again for your time, you gave us a lot to [process, store away]. We hope you too had a benefit from this."`
			`	You say goodbye and as you leave the room you can see a rush of colors reflecting on the walls.`
				decline
			label endNoTime
			`	"[I, we] [understand, are confused]. Safe travels, captain." You notice a slight blue tone in the representative's communication.`
			`	One of them guides you back to your ship.`
